<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>数据读取、处理与保存 &mdash; ricco 1.4.5 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=7d4f1190"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script src="_static/translations.js?v=beaddf03"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="Geocoding" href="geocode.html" />
    <link rel="prev" title="工具集" href="util.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ricco
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">目录:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">主页</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="niubility.html">★★实用方法推荐★★</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">工具集</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">数据读取、处理与保存</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-ricco.etl.extract">数据读取（Extract）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.get_kml_df_with_level"><code class="docutils literal notranslate"><span class="pre">get_kml_df_with_level()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.kml_df_create_level"><code class="docutils literal notranslate"><span class="pre">kml_df_create_level()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.rdf"><code class="docutils literal notranslate"><span class="pre">rdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.rdf_by_dir"><code class="docutils literal notranslate"><span class="pre">rdf_by_dir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.rdxls"><code class="docutils literal notranslate"><span class="pre">rdxls()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_all_sheets"><code class="docutils literal notranslate"><span class="pre">read_all_sheets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_csv"><code class="docutils literal notranslate"><span class="pre">read_csv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_gdb"><code class="docutils literal notranslate"><span class="pre">read_gdb()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_kml"><code class="docutils literal notranslate"><span class="pre">read_kml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_line_json"><code class="docutils literal notranslate"><span class="pre">read_line_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_shapefile"><code class="docutils literal notranslate"><span class="pre">read_shapefile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_shapefile_with_driver"><code class="docutils literal notranslate"><span class="pre">read_shapefile_with_driver()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.extract.read_spss"><code class="docutils literal notranslate"><span class="pre">read_spss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ricco.etl.transformer">数据处理（Transform）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.convert_date"><code class="docutils literal notranslate"><span class="pre">convert_date()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.convert_to_float"><code class="docutils literal notranslate"><span class="pre">convert_to_float()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.create_columns"><code class="docutils literal notranslate"><span class="pre">create_columns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.df_iter"><code class="docutils literal notranslate"><span class="pre">df_iter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.dict2df"><code class="docutils literal notranslate"><span class="pre">dict2df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.drop_by_df"><code class="docutils literal notranslate"><span class="pre">drop_by_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.expand_dict"><code class="docutils literal notranslate"><span class="pre">expand_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.expand_dict_silent"><code class="docutils literal notranslate"><span class="pre">expand_dict_silent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.expand_graph"><code class="docutils literal notranslate"><span class="pre">expand_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.fillna_by_adding"><code class="docutils literal notranslate"><span class="pre">fillna_by_adding()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.filter_by_df"><code class="docutils literal notranslate"><span class="pre">filter_by_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.fix_null"><code class="docutils literal notranslate"><span class="pre">fix_null()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.fuzz_df"><code class="docutils literal notranslate"><span class="pre">fuzz_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.is_changed"><code class="docutils literal notranslate"><span class="pre">is_changed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.keep_best_unique"><code class="docutils literal notranslate"><span class="pre">keep_best_unique()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.null_if_in"><code class="docutils literal notranslate"><span class="pre">null_if_in()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.rolling_by_month"><code class="docutils literal notranslate"><span class="pre">rolling_by_month()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.round_by_columns"><code class="docutils literal notranslate"><span class="pre">round_by_columns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.split_list_to_row"><code class="docutils literal notranslate"><span class="pre">split_list_to_row()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.split_to_rows"><code class="docutils literal notranslate"><span class="pre">split_to_rows()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.table2dict"><code class="docutils literal notranslate"><span class="pre">table2dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.update_df"><code class="docutils literal notranslate"><span class="pre">update_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.transformer.wrap_dict"><code class="docutils literal notranslate"><span class="pre">wrap_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ricco.etl.load">数据保存（Load）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.load.to_csv_by_line"><code class="docutils literal notranslate"><span class="pre">to_csv_by_line()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.load.to_file"><code class="docutils literal notranslate"><span class="pre">to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.load.to_parquet"><code class="docutils literal notranslate"><span class="pre">to_parquet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.load.to_parts_file"><code class="docutils literal notranslate"><span class="pre">to_parts_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.load.to_sheets"><code class="docutils literal notranslate"><span class="pre">to_sheets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ricco.etl.file">文件操作（File）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.df_iter_by_column"><code class="docutils literal notranslate"><span class="pre">df_iter_by_column()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.dir_file_to_x"><code class="docutils literal notranslate"><span class="pre">dir_file_to_x()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.file_to_x"><code class="docutils literal notranslate"><span class="pre">file_to_x()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.gdb2csv"><code class="docutils literal notranslate"><span class="pre">gdb2csv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.merge_csv_files"><code class="docutils literal notranslate"><span class="pre">merge_csv_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.reshape_files"><code class="docutils literal notranslate"><span class="pre">reshape_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.split2x"><code class="docutils literal notranslate"><span class="pre">split2x()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.split2x_by_chunksize"><code class="docutils literal notranslate"><span class="pre">split2x_by_chunksize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.split2x_by_parts"><code class="docutils literal notranslate"><span class="pre">split2x_by_parts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.file.split_csv_by_column"><code class="docutils literal notranslate"><span class="pre">split_csv_by_column()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ricco.etl.entropy">数据标准化（熵值法）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.EntropyClass"><code class="docutils literal notranslate"><span class="pre">EntropyClass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.entropy"><code class="docutils literal notranslate"><span class="pre">entropy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.gevalue"><code class="docutils literal notranslate"><span class="pre">gevalue()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.pca_score"><code class="docutils literal notranslate"><span class="pre">pca_score()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.pvalue"><code class="docutils literal notranslate"><span class="pre">pvalue()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.rescale"><code class="docutils literal notranslate"><span class="pre">rescale()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.standard_e"><code class="docutils literal notranslate"><span class="pre">standard_e()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.standard_e_neg"><code class="docutils literal notranslate"><span class="pre">standard_e_neg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.entropy.wvalue"><code class="docutils literal notranslate"><span class="pre">wvalue()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ricco.etl.graph">图数据处理（Graph）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.graph.get_graph_dict"><code class="docutils literal notranslate"><span class="pre">get_graph_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ricco.etl.graph.query_from_graph"><code class="docutils literal notranslate"><span class="pre">query_from_graph()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="geocode.html">Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="coord_trans.html">坐标转换</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">地理处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="stat.html">统计分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_reporter.html">数据报告</a></li>
<li class="toctree-l1"><a class="reference internal" href="decorator.html">装饰器</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ricco</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">数据读取、处理与保存</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/etl.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>数据读取、处理与保存<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p>该部分为数据去读取、数据处理、数据保存以及对于文件的操作</p>
<section id="module-ricco.etl.extract">
<span id="extract"></span><h2>数据读取（Extract）<a class="headerlink" href="#module-ricco.etl.extract" title="Link to this heading"></a></h2>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.get_kml_df_with_level" title="ricco.etl.extract.get_kml_df_with_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_kml_df_with_level</span></code></a>(gdf_dict)</p></td>
<td><p>从中gdf_dict读取数据以及文件夹名称,并构造文件夹层级,按照指定层级合并所 有数据,并打上层级标签</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.extract.kml_df_create_level" title="ricco.etl.extract.kml_df_create_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kml_df_create_level</span></code></a>(gdf_dict)</p></td>
<td><p>读取 dict {level: gpd.GeoDataFrame} 字典, 并根据[name]列包含关系提取分辨文件夹层级</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.rdf" title="ricco.etl.extract.rdf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rdf</span></code></a>(file_path, *[, sheet_name, ...])</p></td>
<td><p>常用文件读取函数，支持 .csv/.xlsx/.xls/.shp/.parquet/.pickle/.feather/.kml/.ovkml/ .geojson/.shp/.json等</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.extract.rdf_by_dir" title="ricco.etl.extract.rdf_by_dir"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rdf_by_dir</span></code></a>(dir_path[, exts, ignore_index, ...])</p></td>
<td><p>从文件夹中读取所有文件并拼接成一个DataFrame</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.rdxls" title="ricco.etl.extract.rdxls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rdxls</span></code></a>(file_path, *[, sheet_name, ...])</p></td>
<td><p>读取excel文件</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.extract.read_all_sheets" title="ricco.etl.extract.read_all_sheets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_all_sheets</span></code></a>(file_path[, sheet_names, ...])</p></td>
<td><p>读取并合并所有sheet表</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.read_csv" title="ricco.etl.extract.read_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_csv</span></code></a>(file_path, *[, encoding, dtype, ...])</p></td>
<td><p>读取csv文件，基于 <cite>pd.read_csv</cite>，加入编码尝试</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.extract.read_gdb" title="ricco.etl.extract.read_gdb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_gdb</span></code></a>(dir_path)</p></td>
<td><p>读取gdb文件夹</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.read_kml" title="ricco.etl.extract.read_kml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_kml</span></code></a>(file_path[, keep_level])</p></td>
<td><p>读取kml类文件,将其转换成DataFrame, 根据separate_folders选择是否拆分, 输出仅保留[name, geometry]字段,暂时只支持polygon和multipolygon数据</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.extract.read_line_json" title="ricco.etl.extract.read_line_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_line_json</span></code></a>(file_path[, encoding])</p></td>
<td><p>逐行读取json格式的文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.read_shapefile" title="ricco.etl.extract.read_shapefile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_shapefile</span></code></a>(file_path, **kwargs)</p></td>
<td><p>读取shapefile或geojson文件</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.extract.read_shapefile_with_driver" title="ricco.etl.extract.read_shapefile_with_driver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_shapefile_with_driver</span></code></a>(file_path[, encoding])</p></td>
<td><p>读取shapefile文件，分别读取dbf中的属性表和shp中的geometry进行拼接</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.extract.read_spss" title="ricco.etl.extract.read_spss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_spss</span></code></a>(file_path[, columns, nrows, encoding])</p></td>
<td><p>读取SPSS的.sav文件</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.get_kml_df_with_level">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">get_kml_df_with_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gdf_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.get_kml_df_with_level" title="Link to this definition"></a></dt>
<dd><p>从中gdf_dict读取数据以及文件夹名称,并构造文件夹层级,按照指定层级合并所
有数据,并打上层级标签</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gdf_dict</strong> – GeoDataFrame组成的字典，key为文件夹名称, value为对应数据：{level: gpd.GeoDataFrame}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.kml_df_create_level">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">kml_df_create_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gdf_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#ricco.etl.extract.kml_df_create_level" title="Link to this definition"></a></dt>
<dd><p>读取 dict {level: gpd.GeoDataFrame} 字典, 并根据[name]列包含关系提取分辨文件夹层级</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gdf_dict</strong> – {dict} {level: gpd.GeoDataFrame} key为文件夹名称, value为对应数据</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>{‘板块名称’: 0, ‘T顶豪’: 1, ‘O1远郊品质’: 2}</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>文件夹层级字典，如</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.rdf">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">rdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_contains:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'str'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursive:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.rdf" title="Link to this definition"></a></dt>
<dd><p>常用文件读取函数，支持
.csv/.xlsx/.xls/.shp/.parquet/.pickle/.feather/.kml/.ovkml/
.geojson/.shp/.json等</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> – 文件或文件夹路径</p></li>
<li><p><strong>sheet_name</strong> – 数据所在sheet的名称，仅对.xlsx/.xls生效</p></li>
<li><p><strong>sheet_contains</strong> – 筛选sheet名称中包含此字符串的sheet，仅对.xlsx/.xls生效</p></li>
<li><p><strong>encoding</strong> – 编码</p></li>
<li><p><strong>info</strong> – 是否打印数据集情况（shape &amp; columns）</p></li>
<li><p><strong>dtype</strong> – 指定读取列的类型</p></li>
<li><p><strong>columns</strong> – 指定读取的列名</p></li>
<li><p><strong>nrows</strong> – 指定读取的行数</p></li>
<li><p><strong>recursive</strong> – 是否循环遍历更深层级的文件夹，默认为True，仅当路径为文件夹时生效</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.rdf_by_dir">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">rdf_by_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursive=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'str'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign_data_from:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_data_from:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'__data_from'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.rdf_by_dir" title="Link to this definition"></a></dt>
<dd><p>从文件夹中读取所有文件并拼接成一个DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_path</strong> – 文件夹路径</p></li>
<li><p><strong>exts</strong> – 要读取的文件扩展名</p></li>
<li><p><strong>ignore_index</strong> – 是否忽略索引</p></li>
<li><p><strong>recursive</strong> – 是否循环遍历更深层级的文件夹</p></li>
<li><p><strong>columns</strong> – 指定列名</p></li>
<li><p><strong>info</strong> – 是否打印基本信息（列名、行列数）</p></li>
<li><p><strong>sign_data_from</strong> – 是否标记数据来源于哪个文件，默认不标记</p></li>
<li><p><strong>col_data_from</strong> – 用于标记数据来源文件的列名</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.rdxls">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">rdxls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_contains:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'str'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.rdxls" title="Link to this definition"></a></dt>
<dd><p>读取excel文件</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> – 文件名</p></li>
<li><p><strong>sheet_name</strong> – sheet表的名称</p></li>
<li><p><strong>sheet_contains</strong> – sheet表包含的字符串</p></li>
<li><p><strong>dtype</strong> – 指定读取列的类型</p></li>
<li><p><strong>columns</strong> – 指定读取的列</p></li>
<li><p><strong>nrows</strong> – 指定读取的行数</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_all_sheets">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_all_sheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_diff_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.extract.read_all_sheets" title="Link to this definition"></a></dt>
<dd><p>读取并合并所有sheet表</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> – Excel文件路径</p></li>
<li><p><strong>sheet_names</strong> – 要读取并合并的sheet列表，默认读取全部的sheet</p></li>
<li><p><strong>ignore_diff_columns</strong> – 如果每个sheet中的字段名不一致，是否要忽略</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_csv">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'str'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.extract.read_csv" title="Link to this definition"></a></dt>
<dd><p>读取csv文件，基于 <cite>pd.read_csv</cite>，加入编码尝试</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_gdb">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_gdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.extract.read_gdb" title="Link to this definition"></a></dt>
<dd><p>读取gdb文件夹</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_kml">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_kml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.read_kml" title="Link to this definition"></a></dt>
<dd><p>读取kml类文件,将其转换成DataFrame, 根据separate_folders选择是否拆分,
输出仅保留[name, geometry]字段,暂时只支持polygon和multipolygon数据</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> – kml or ovkml文件路径</p></li>
<li><p><strong>keep_level</strong> – 是否保留文件夹层级标签</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_line_json">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_line_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.read_line_json" title="Link to this definition"></a></dt>
<dd><p>逐行读取json格式的文件</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> – 文件名</p></li>
<li><p><strong>encoding</strong> – 文件编码，默认为utf-8</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_shapefile">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_shapefile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.extract.read_shapefile" title="Link to this definition"></a></dt>
<dd><p>读取shapefile或geojson文件</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_shapefile_with_driver">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_shapefile_with_driver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#ricco.etl.extract.read_shapefile_with_driver" title="Link to this definition"></a></dt>
<dd><p>读取shapefile文件，分别读取dbf中的属性表和shp中的geometry进行拼接</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.extract.read_spss">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.extract.</span></span><span class="sig-name descname"><span class="pre">read_spss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.extract.read_spss" title="Link to this definition"></a></dt>
<dd><p>读取SPSS的.sav文件</p>
</dd></dl>

</section>
<section id="module-ricco.etl.transformer">
<span id="transform"></span><h2>数据处理（Transform）<a class="headerlink" href="#module-ricco.etl.transformer" title="Link to this heading"></a></h2>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.convert_date" title="ricco.etl.transformer.convert_date"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_date</span></code></a>(df, columns[, mode])</p></td>
<td><p>将日期转为当月的第一天或最后一天</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.convert_to_float" title="ricco.etl.transformer.convert_to_float"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_to_float</span></code></a>(df, columns[, rex_method])</p></td>
<td><p>提取字符串中的数值信息并转为float类型</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.create_columns" title="ricco.etl.transformer.create_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_columns</span></code></a>(df, columns[, value])</p></td>
<td><p>创建新的列，默认为空</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.df_iter" title="ricco.etl.transformer.df_iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">df_iter</span></code></a>(df, *[, chunksize, parts])</p></td>
<td><p>DataFrame切片生成器</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.dict2df" title="ricco.etl.transformer.dict2df"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict2df</span></code></a>(data[, c_key, c_value, as_index])</p></td>
<td><p>将字典转为dataframe</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.drop_by_df" title="ricco.etl.transformer.drop_by_df"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_by_df</span></code></a>(df, df_deleted)</p></td>
<td><p>根据一个df_deleted中的数据从df中删除</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.expand_dict" title="ricco.etl.transformer.expand_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_dict</span></code></a>(df, c_src)</p></td>
<td><p>展开字典为多列</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.expand_dict_silent" title="ricco.etl.transformer.expand_dict_silent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_dict_silent</span></code></a>(df, c_src)</p></td>
<td><p>展开字典为多列</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.expand_graph" title="ricco.etl.transformer.expand_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_graph</span></code></a>(df, start_level[, c_key, ...])</p></td>
<td><p>将图数据展开为宽表</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.fillna_by_adding" title="ricco.etl.transformer.fillna_by_adding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fillna_by_adding</span></code></a>(df, col)</p></td>
<td><p>以自增的方式填充空值</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.filter_by_df" title="ricco.etl.transformer.filter_by_df"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_df</span></code></a>(df, df_sizer[, reverse])</p></td>
<td><p>从df中筛选出满足df_size的数据</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.fix_null" title="ricco.etl.transformer.fix_null"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_null</span></code></a>(df[, columns])</p></td>
<td><p>将None/NaN/NaT等都替换为None</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.fuzz_df" title="ricco.etl.transformer.fuzz_df"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fuzz_df</span></code></a>(df, col, target_series[, c_dst, ...])</p></td>
<td><p>模糊匹配。为DataFrame中的某一列从某个集合中模糊匹配匹配相似度最高的元素</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.is_changed" title="ricco.etl.transformer.is_changed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_changed</span></code></a>(df_old, df_new[, key_cols, ...])</p></td>
<td><p>判断新旧数据集中的每一条数据是否变化</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.keep_best_unique" title="ricco.etl.transformer.keep_best_unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_best_unique</span></code></a>(df, subset[, value_cols])</p></td>
<td><p>优化的去重函数，为保证数据的完整性，去重时优先去除指定列中的空值</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.null_if_in" title="ricco.etl.transformer.null_if_in"><code class="xref py py-obj docutils literal notranslate"><span class="pre">null_if_in</span></code></a>(df, columns, values)</p></td>
<td><p>如果列的值正好在values中定义的数组中，则将该列值设置为None</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.rolling_by_month" title="ricco.etl.transformer.rolling_by_month"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_by_month</span></code></a>(df, c_date, c_group, ...)</p></td>
<td><p>按照日期进行滚动聚合，比如：分组对某个项目计算近6个月的成交面积</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.round_by_columns" title="ricco.etl.transformer.round_by_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">round_by_columns</span></code></a>(df, columns)</p></td>
<td><p>对整列进行四舍五入，默认绝对值大于1的数值保留两位小数，小于1 的保留4位</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.split_list_to_row" title="ricco.etl.transformer.split_list_to_row"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_list_to_row</span></code></a>(df, column)</p></td>
<td><p>将列表列中列表的元素拆成多行</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.split_to_rows" title="ricco.etl.transformer.split_to_rows"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_to_rows</span></code></a>(df, column[, delimiter])</p></td>
<td><p>含有多值的列分拆成多行</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.table2dict" title="ricco.etl.transformer.table2dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">table2dict</span></code></a>(df[, key_col, value_col, orient])</p></td>
<td><p>DataFrame转字典</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.transformer.update_df" title="ricco.etl.transformer.update_df"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_df</span></code></a>(df, new_df[, on, overwrite, errors])</p></td>
<td><p>根据某一列更新dataframe里的数据</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.transformer.wrap_dict" title="ricco.etl.transformer.wrap_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wrap_dict</span></code></a>(df[, c_srcs, c_dst])</p></td>
<td><p>将指定的多列合并成一个字典列 :param df: 要处理的数据集 :param c_srcs: 需要包装成字典的多列, 如果不指定，则wrap所有的列 :param c_dst: 处理后的数据存储的列名称，默认为 'extra'</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.convert_date">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">convert_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'first'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.convert_date" title="Link to this definition"></a></dt>
<dd><p>将日期转为当月的第一天或最后一天</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要处理的DataFrame</p></li>
<li><p><strong>columns</strong> – 要转换的列</p></li>
<li><p><strong>mode</strong> – ‘first’ or ‘last’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.convert_to_float">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">convert_to_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'str'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rex_method:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'mean'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.convert_to_float" title="Link to this definition"></a></dt>
<dd><p>提取字符串中的数值信息并转为float类型</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要转换的DataFrame</p></li>
<li><p><strong>columns</strong> – 要转换的列</p></li>
<li><p><strong>rex_method</strong> – 计算mean,max,min， 默认为mean</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.create_columns">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">create_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.create_columns" title="Link to this definition"></a></dt>
<dd><p>创建新的列，默认为空</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – DataFrame</p></li>
<li><p><strong>columns</strong> – 列名</p></li>
<li><p><strong>value</strong> – 值，默认为空</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.df_iter">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">df_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.df_iter" title="Link to this definition"></a></dt>
<dd><p>DataFrame切片生成器</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要切片的DataFrame</p></li>
<li><p><strong>chunksize</strong> – 每次返回的大小，与parts必须指定一个</p></li>
<li><p><strong>parts</strong> – 返回的次数，与chunksize必须指定一个</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.dict2df">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">dict2df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'key'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.dict2df" title="Link to this definition"></a></dt>
<dd><p>将字典转为dataframe</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.drop_by_df">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">drop_by_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_deleted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.drop_by_df" title="Link to this definition"></a></dt>
<dd><p>根据一个df_deleted中的数据从df中删除</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.expand_dict">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">expand_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_src</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.expand_dict" title="Link to this definition"></a></dt>
<dd><p>展开字典为多列</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.expand_dict_silent">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">expand_dict_silent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_src</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.expand_dict_silent" title="Link to this definition"></a></dt>
<dd><p>展开字典为多列</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.expand_graph">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">expand_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_level_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'level_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'parent_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.expand_graph" title="Link to this definition"></a></dt>
<dd><p>将图数据展开为宽表</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要展开的图数据</p></li>
<li><p><strong>start_level</strong> – 开始展开的层级，一般是最低层级</p></li>
<li><p><strong>c_key</strong> – 关键列</p></li>
<li><p><strong>c_level_type</strong> – 层级类型列</p></li>
<li><p><strong>c_parent_key</strong> – 父级关键列</p></li>
<li><p><strong>c_info</strong> – 要保留的其他列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.fillna_by_adding">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">fillna_by_adding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.fillna_by_adding" title="Link to this definition"></a></dt>
<dd><p>以自增的方式填充空值</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.filter_by_df">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">filter_by_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_sizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.filter_by_df" title="Link to this definition"></a></dt>
<dd><p>从df中筛选出满足df_size的数据</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.fix_null">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">fix_null</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.fix_null" title="Link to this definition"></a></dt>
<dd><p>将None/NaN/NaT等都替换为None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.fuzz_df">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">fuzz_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_series:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pandas.core.series.Series'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_dst:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_score=60</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.fuzz_df" title="Link to this definition"></a></dt>
<dd><p>模糊匹配。为DataFrame中的某一列从某个集合中模糊匹配匹配相似度最高的元素</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 输入的dataframe</p></li>
<li><p><strong>col</strong> – 要匹配的列</p></li>
<li><p><strong>target_series</strong> – 从何处匹配， list/pd.Series</p></li>
<li><p><strong>c_dst</strong> – 关联后输出的列名，默认为原列名+”_target”后缀</p></li>
<li><p><strong>valid_score</strong> – 相似度大于该值的才返回，默认60</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.is_changed">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">is_changed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_old:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_new:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_cols:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_cols:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_res:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'is_changed'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.is_changed" title="Link to this definition"></a></dt>
<dd><p>判断新旧数据集中的每一条数据是否变化</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_old</strong> – 原始数据集</p></li>
<li><p><strong>df_new</strong> – 修改后的数据集</p></li>
<li><p><strong>key_cols</strong> – 关键列，不指定则以索引列为准</p></li>
<li><p><strong>value_cols</strong> – 要对比的列，默认出key_cols之外的其他列</p></li>
<li><p><strong>c_res</strong> – 对比结果列名，默认为“is_changed”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.keep_best_unique">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">keep_best_unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset:</span> <span class="pre">(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'str'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_cols:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.keep_best_unique" title="Link to this definition"></a></dt>
<dd><p>优化的去重函数，为保证数据的完整性，去重时优先去除指定列中的空值</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要去重的Dataframe</p></li>
<li><p><strong>subset</strong> – 按照哪些列去重</p></li>
<li><p><strong>value_cols</strong> – 优先去除那些列的空值，该列表是有顺序的</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.null_if_in">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">null_if_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values:</span> <span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.null_if_in" title="Link to this definition"></a></dt>
<dd><p>如果列的值正好在values中定义的数组中，则将该列值设置为None</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – </p></li>
<li><p><strong>columns</strong> – 需要检查的列，一个或多少</p></li>
<li><p><strong>values</strong> – 所有需要标识为None的值</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.rolling_by_month">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">rolling_by_month</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">months</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.rolling_by_month" title="Link to this definition"></a></dt>
<dd><p>按照日期进行滚动聚合，比如：分组对某个项目计算近6个月的成交面积</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 输入的dataframe</p></li>
<li><p><strong>c_date</strong> – 日期列</p></li>
<li><p><strong>c_group</strong> – 分组列</p></li>
<li><p><strong>months</strong> – 窗口大小</p></li>
<li><p><strong>agg</strong> – 聚合函数，如：{‘金额’: ‘sum’}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.round_by_columns">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">round_by_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.round_by_columns" title="Link to this definition"></a></dt>
<dd><p>对整列进行四舍五入，默认绝对值大于1的数值保留两位小数，小于1 的保留4位</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.split_list_to_row">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">split_list_to_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.split_list_to_row" title="Link to this definition"></a></dt>
<dd><p>将列表列中列表的元素拆成多行</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.split_to_rows">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">split_to_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'|'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.split_to_rows" title="Link to this definition"></a></dt>
<dd><p>含有多值的列分拆成多行</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – </p></li>
<li><p><strong>column</strong> – 存在多值的列</p></li>
<li><p><strong>delimiter</strong> – 多个值之间的分割符</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.table2dict">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">table2dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_col:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_col:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'dict'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#ricco.etl.transformer.table2dict" title="Link to this definition"></a></dt>
<dd><p>DataFrame转字典</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – </p></li>
<li><p><strong>key_col</strong> – 生成key的列</p></li>
<li><p><strong>value_col</strong> – 生成value的列</p></li>
<li><p><strong>orient</strong> – 生成dict的方式，默认 ‘dict’,还有 ‘list’, ‘series’, ‘split’, ‘records’, ‘index’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.update_df">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">update_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_df:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'ignore'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.transformer.update_df" title="Link to this definition"></a></dt>
<dd><p>根据某一列更新dataframe里的数据</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 待升级的数据集</p></li>
<li><p><strong>new_df</strong> – 用于更新的DataFrame</p></li>
<li><p><strong>on</strong> – （可选参数）用于判断更新哪些行的列</p></li>
<li><p><strong>overwrite</strong> – <p>（可选参数）控制如何处理原DataFrame在重叠位置上 <strong>非空</strong> 的值，默认为True</p>
<ul>
<li><p>True: 默认值；使用 <cite>other</cite> DataFrame中的值覆盖原DataFrame中相应位置的值.</p></li>
<li><p>False: 只更新原DataFrame中重叠位置数据为 <em>空</em> 的值.</p></li>
</ul>
</p></li>
<li><p><strong>errors</strong> – <p>（可选参数）控制如何处理两个DataFrame同一位置都有值的行为，默认为 ‘ignore’</p>
<ul>
<li><p>’ignore’: 默认值；DataFrame类型 df和other在同一个cell位置都是非NA值，
使用other中的值替换df中的值。</p></li>
<li><p>’raise’: target和other都在同一位置包含非NA数据将抛出ValueError异常（’Data overlaps’）。</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.transformer.wrap_dict">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.transformer.</span></span><span class="sig-name descname"><span class="pre">wrap_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_srcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_dst</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'extra'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.transformer.wrap_dict" title="Link to this definition"></a></dt>
<dd><p>将指定的多列合并成一个字典列
:param df: 要处理的数据集
:param c_srcs: 需要包装成字典的多列, 如果不指定，则wrap所有的列
:param c_dst: 处理后的数据存储的列名称，默认为 ‘extra’</p>
</dd></dl>

</section>
<section id="module-ricco.etl.load">
<span id="load"></span><h2>数据保存（Load）<a class="headerlink" href="#module-ricco.etl.load" title="Link to this heading"></a></h2>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.load.to_csv_by_line" title="ricco.etl.load.to_csv_by_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_csv_by_line</span></code></a>(data, filename)</p></td>
<td><p>逐行写入csv文件</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.load.to_file" title="ricco.etl.load.to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_file</span></code></a>(df, filepath, *[, index, log, encoding])</p></td>
<td><p>根据文件扩展名，将Dataframe保存为文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.load.to_parquet" title="ricco.etl.load.to_parquet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_parquet</span></code></a>(df, filepath, index)</p></td>
<td><p>保存parquet文件，默认将shapely对象转换为wkb格式</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.load.to_parts_file" title="ricco.etl.load.to_parts_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_parts_file</span></code></a>(df, dirpath[, chunksize, ...])</p></td>
<td><p>将Dataframe保存为多个文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.load.to_sheets" title="ricco.etl.load.to_sheets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_sheets</span></code></a>(data, filename[, index])</p></td>
<td><p>将多个dataframe保存到不同的sheet中</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.load.to_csv_by_line">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.load.</span></span><span class="sig-name descname"><span class="pre">to_csv_by_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.load.to_csv_by_line" title="Link to this definition"></a></dt>
<dd><p>逐行写入csv文件</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 要写入的数据列表</p></li>
<li><p><strong>filename</strong> – 文件名</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.load.to_file">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.load.</span></span><span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.load.to_file" title="Link to this definition"></a></dt>
<dd><p>根据文件扩展名，将Dataframe保存为文件</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要保存的Dataframe</p></li>
<li><p><strong>filepath</strong> – 文件路径，包含扩展名</p></li>
<li><p><strong>index</strong> – 是否保存索引，默认不保存</p></li>
<li><p><strong>log</strong> – 是否打印保存信息</p></li>
<li><p><strong>encoding</strong> – 保存文件的编码</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.load.to_parquet">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.load.</span></span><span class="sig-name descname"><span class="pre">to_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.load.to_parquet" title="Link to this definition"></a></dt>
<dd><p>保存parquet文件，默认将shapely对象转换为wkb格式</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.load.to_parts_file">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.load.</span></span><span class="sig-name descname"><span class="pre">to_parts_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.csv'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.load.to_parts_file" title="Link to this definition"></a></dt>
<dd><p>将Dataframe保存为多个文件</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 要拆分保存的DataFrame</p></li>
<li><p><strong>dirpath</strong> – 文件保存的目录</p></li>
<li><p><strong>chunksize</strong> – 拆分保存的文件大小</p></li>
<li><p><strong>parts</strong> – 拆分保存的文件数量</p></li>
<li><p><strong>to_ext</strong> – 文件扩展名</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.load.to_sheets">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.load.</span></span><span class="sig-name descname"><span class="pre">to_sheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.load.to_sheets" title="Link to this definition"></a></dt>
<dd><p>将多个dataframe保存到不同的sheet中</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 要保存的数据集，格式为：{sheet_name: DataFrame}</p></li>
<li><p><strong>filename</strong> – 要保存的文件名</p></li>
<li><p><strong>index</strong> – 是否保存index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ricco.etl.file">
<span id="file"></span><h2>文件操作（File）<a class="headerlink" href="#module-ricco.etl.file" title="Link to this heading"></a></h2>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.file.df_iter_by_column" title="ricco.etl.file.df_iter_by_column"><code class="xref py py-obj docutils literal notranslate"><span class="pre">df_iter_by_column</span></code></a>(df, by[, na])</p></td>
<td><p>按列的值分组迭代df</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.file.dir_file_to_x" title="ricco.etl.file.dir_file_to_x"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dir_file_to_x</span></code></a>(from_dir, to_dir[, from_ext, ...])</p></td>
<td><p>转换整个目录中的文件格式</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.file.file_to_x" title="ricco.etl.file.file_to_x"><code class="xref py py-obj docutils literal notranslate"><span class="pre">file_to_x</span></code></a>(filepath, to_ext[, to_dir, ...])</p></td>
<td><p>文件格式转换，整体读取并转换，将文件整体加载到内存中再保存为另一种文件格式</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.file.gdb2csv" title="ricco.etl.file.gdb2csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gdb2csv</span></code></a>(dir_path[, output_path, ...])</p></td>
<td><p>gdb文件转换为csv文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.file.merge_csv_files" title="ricco.etl.file.merge_csv_files"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_csv_files</span></code></a>(dir_path, output_file)</p></td>
<td><p>合并指定目录下的所有CSV文件到一个输出文件中，极低内存消耗</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.file.reshape_files" title="ricco.etl.file.reshape_files"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reshape_files</span></code></a>(from_dir, to_dir[, from_ext, ...])</p></td>
<td><p>将文件拆分成小文件，并保存到to_dir中</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.file.split2x" title="ricco.etl.file.split2x"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split2x</span></code></a>(filename, *[, chunksize, parts, ...])</p></td>
<td><p>将文件拆分为多个文件，放置在与文件同名目录下</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.file.split2x_by_chunksize" title="ricco.etl.file.split2x_by_chunksize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split2x_by_chunksize</span></code></a>(filepath, *[, ...])</p></td>
<td><p>将文件拆分为多个文件，放置在与文件同名目录下</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.file.split2x_by_parts" title="ricco.etl.file.split2x_by_parts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split2x_by_parts</span></code></a>(filename, *[, parts, ...])</p></td>
<td><p>将文件拆分为多个文件，放置在与文件同名目录下</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.file.split_csv_by_column" title="ricco.etl.file.split_csv_by_column"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_csv_by_column</span></code></a>(filepath, by, *[, ...])</p></td>
<td><p>将csv文件按指定列的值拆分为多个文件</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.df_iter_by_column">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">df_iter_by_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">na</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'null'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.df_iter_by_column" title="Link to this definition"></a></dt>
<dd><p>按列的值分组迭代df</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.dir_file_to_x">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">dir_file_to_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.dir_file_to_x" title="Link to this definition"></a></dt>
<dd><p>转换整个目录中的文件格式</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.file_to_x">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">file_to_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.file_to_x" title="Link to this definition"></a></dt>
<dd><p>文件格式转换，整体读取并转换，将文件整体加载到内存中再保存为另一种文件格式</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – 待转换的文件路径</p></li>
<li><p><strong>to_ext</strong> – 要保存的文件扩展名</p></li>
<li><p><strong>to_dir</strong> – 要写入的文件路径，默认存放在原目录</p></li>
<li><p><strong>delete</strong> – 是否删除原文件，默认不删除</p></li>
<li><p><strong>overwrite</strong> – 是否覆盖原文件，默认不覆盖</p></li>
<li><p><strong>log</strong> – 是否输出文件保存、删除日志</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.gdb2csv">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">gdb2csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wkb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.gdb2csv" title="Link to this definition"></a></dt>
<dd><p>gdb文件转换为csv文件</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.merge_csv_files">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">merge_csv_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.merge_csv_files" title="Link to this definition"></a></dt>
<dd><p>合并指定目录下的所有CSV文件到一个输出文件中，极低内存消耗</p>
<p>参数:
- csv_dir: CSV文件所在的目录
- output_file: 合并后的输出CSV文件路径</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.reshape_files">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">reshape_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.reshape_files" title="Link to this definition"></a></dt>
<dd><p>将文件拆分成小文件，并保存到to_dir中</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_dir</strong> – 读取的目录</p></li>
<li><p><strong>to_dir</strong> – 保存的目录</p></li>
<li><p><strong>from_ext</strong> – 读取的扩展名，默认为None，全部读取</p></li>
<li><p><strong>to_ext</strong> – 保存的扩展名，默认为None，若读取文件的扩展名唯一，则使用读文文件的扩展名，反之需要指定</p></li>
<li><p><strong>chunksize</strong> – 每个文件的大小</p></li>
<li><p><strong>func</strong> – 自定义处理函数</p></li>
<li><p><strong>log</strong> – 是否打印日志</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.split2x">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">split2x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.split2x" title="Link to this definition"></a></dt>
<dd><p>将文件拆分为多个文件，放置在与文件同名目录下</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 输入的文件路径</p></li>
<li><p><strong>chunksize</strong> – 每份文件的数据量</p></li>
<li><p><strong>parts</strong> – 输出的文件个数</p></li>
<li><p><strong>to_ext</strong> – 输出的文件扩展名</p></li>
<li><p><strong>log</strong> – 是否输出文件保存信息</p></li>
<li><p><strong>fn</strong> – 处理函数</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.split2x_by_chunksize">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">split2x_by_chunksize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.split2x_by_chunksize" title="Link to this definition"></a></dt>
<dd><p>将文件拆分为多个文件，放置在与文件同名目录下</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – 输入的文件路径</p></li>
<li><p><strong>chunksize</strong> – 每份文件的数据量</p></li>
<li><p><strong>to_ext</strong> – 输出文件扩展名</p></li>
<li><p><strong>log</strong> – 是否输出文件保存信息</p></li>
<li><p><strong>fn</strong> – 处理函数</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.split2x_by_parts">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">split2x_by_parts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.split2x_by_parts" title="Link to this definition"></a></dt>
<dd><p>将文件拆分为多个文件，放置在与文件同名目录下</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 文件路径</p></li>
<li><p><strong>parts</strong> – 输出的文件个数</p></li>
<li><p><strong>to_ext</strong> – 输出文件扩展名</p></li>
<li><p><strong>log</strong> – 是否输出文件保存信息</p></li>
<li><p><strong>fn</strong> – 处理函数</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.file.split_csv_by_column">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.file.</span></span><span class="sig-name descname"><span class="pre">split_csv_by_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.file.split_csv_by_column" title="Link to this definition"></a></dt>
<dd><p>将csv文件按指定列的值拆分为多个文件</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – csv文件路径</p></li>
<li><p><strong>by</strong> – 根据那一列拆分</p></li>
<li><p><strong>to_dir</strong> – 要保存的位置，默认与原文件同名目录</p></li>
<li><p><strong>to_ext</strong> – 输出的文件扩展名</p></li>
<li><p><strong>merge_file</strong> – 是否将每一类数据合并为一个文件，默认合并</p></li>
<li><p><strong>chunksize</strong> – 中间文件大小，如内存不足则可适当调低</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ricco.etl.entropy">
<span id="id2"></span><h2>数据标准化（熵值法）<a class="headerlink" href="#module-ricco.etl.entropy" title="Link to this heading"></a></h2>
<p><strong>Classes:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.entropy.EntropyClass" title="ricco.etl.entropy.EntropyClass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EntropyClass</span></code></a>(df, cols, neg_cols, key)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.entropy.entropy" title="ricco.etl.entropy.entropy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy</span></code></a>(df[, columns])</p></td>
<td><p>采用熵值法计算的总分评价</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.entropy.gevalue" title="ricco.etl.entropy.gevalue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gevalue</span></code></a>(df, columns)</p></td>
<td><p>计算指标的差异系数</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.entropy.pca_score" title="ricco.etl.entropy.pca_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pca_score</span></code></a>(df[, columns])</p></td>
<td><p>PCA法计算器</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.entropy.pvalue" title="ricco.etl.entropy.pvalue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalue</span></code></a>(df, columns)</p></td>
<td><p>计算指标下任一数值在该指标中的比重</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.entropy.rescale" title="ricco.etl.entropy.rescale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale</span></code></a>(df, key[, scale_min, scale_max, ...])</p></td>
<td><p>归一化处理</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.entropy.standard_e" title="ricco.etl.entropy.standard_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_e</span></code></a>(df, columns)</p></td>
<td><p>熵值法的正向指标的极差标准化</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.entropy.standard_e_neg" title="ricco.etl.entropy.standard_e_neg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_e_neg</span></code></a>(df, columns)</p></td>
<td><p>熵值法的负向指标的极差标准化</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.entropy.wvalue" title="ricco.etl.entropy.wvalue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wvalue</span></code></a>(df, columns)</p></td>
<td><p>计算指标之间的权重关系</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="ricco.etl.entropy.EntropyClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">EntropyClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.EntropyClass" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.entropy">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.entropy" title="Link to this definition"></a></dt>
<dd><p>采用熵值法计算的总分评价</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 非负数化处理后的数据，默认其中数值量纲都是越大越好</p></li>
<li><p><strong>columns</strong> – 需要用熵值法计算权重的指标合集</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>用过熵值法得到的总分, 权重</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.gevalue">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">gevalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.gevalue" title="Link to this definition"></a></dt>
<dd><p>计算指标的差异系数</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.pca_score">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">pca_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.pca_score" title="Link to this definition"></a></dt>
<dd><p>PCA法计算器</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.pvalue">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">pvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.pvalue" title="Link to this definition"></a></dt>
<dd><p>计算指标下任一数值在该指标中的比重</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.rescale">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">rescale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">100)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ricco.etl.entropy.rescale" title="Link to this definition"></a></dt>
<dd><p>归一化处理</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – 为原始待计算df</p></li>
<li><p><strong>key</strong> – 需要参与计算的列名</p></li>
<li><p><strong>scale_min</strong> – 下分位数, 低于该分位数的结果均取最小值</p></li>
<li><p><strong>scale_max</strong> – 上分位数, 高于该分位数的结果均取最大值</p></li>
<li><p><strong>score_range</strong> – 得分范围</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.standard_e">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">standard_e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.standard_e" title="Link to this definition"></a></dt>
<dd><p>熵值法的正向指标的极差标准化</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.standard_e_neg">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">standard_e_neg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.standard_e_neg" title="Link to this definition"></a></dt>
<dd><p>熵值法的负向指标的极差标准化</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.entropy.wvalue">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.entropy.</span></span><span class="sig-name descname"><span class="pre">wvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ricco.etl.entropy.wvalue" title="Link to this definition"></a></dt>
<dd><p>计算指标之间的权重关系</p>
</dd></dl>

</section>
<section id="module-ricco.etl.graph">
<span id="graph"></span><h2>图数据处理（Graph）<a class="headerlink" href="#module-ricco.etl.graph" title="Link to this heading"></a></h2>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ricco.etl.graph.get_graph_dict" title="ricco.etl.graph.get_graph_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_graph_dict</span></code></a>(graph_df[, c_key, ...])</p></td>
<td><p>将图结构的Dataframe转为字典格式，提高查询效率</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ricco.etl.graph.query_from_graph" title="ricco.etl.graph.query_from_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_from_graph</span></code></a>(key, graph_data[, c_key, ...])</p></td>
<td><p>从图数据中查询全部当前节点的全部父级节点</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.graph.get_graph_dict">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.graph.</span></span><span class="sig-name descname"><span class="pre">get_graph_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_level_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'level_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'parent_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_parent_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'parent_type'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#ricco.etl.graph.get_graph_dict" title="Link to this definition"></a></dt>
<dd><p>将图结构的Dataframe转为字典格式，提高查询效率</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph_df</strong> – 图结构的数据</p></li>
<li><p><strong>c_key</strong> – 索引列</p></li>
<li><p><strong>c_level_type</strong> – 层级分类列</p></li>
<li><p><strong>c_parent_key</strong> – 对应的父级索引列</p></li>
<li><p><strong>c_parent_type</strong> – 对应的父级类型列</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ricco.etl.graph.query_from_graph">
<span class="sig-prename descclassname"><span class="pre">ricco.etl.graph.</span></span><span class="sig-name descname"><span class="pre">query_from_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_data:</span> <span class="pre">(&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'dict'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_key='id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_level_type='level_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_parent_key='parent_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth=10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#ricco.etl.graph.query_from_graph" title="Link to this definition"></a></dt>
<dd><p>从图数据中查询全部当前节点的全部父级节点</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – 要查询的节点</p></li>
<li><p><strong>graph_data</strong> – 要查询的数据集</p></li>
<li><p><strong>c_key</strong> – 子节点关键列的字段名</p></li>
<li><p><strong>c_level_type</strong> – 等级类型字段名</p></li>
<li><p><strong>c_parent_key</strong> – 父节点字段名</p></li>
<li><p><strong>max_depth</strong> – 最大深度</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="util.html" class="btn btn-neutral float-left" title="工具集" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="geocode.html" class="btn btn-neutral float-right" title="Geocoding" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024, wangyukang。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>